/*!
 * RWD Images v0.4.3
 *
 * A lightweight, customisable responsive image solution, which uses a familar media query syntax
 *
 * Copyright (c) 2014 Matt Stow
 *
 * http://mattstow.com
 *
 * Licensed under the MIT license
*/
;(function(p,B){var s,A;if(B.getElementsByClassName){s=B.getElementsByClassName("rwdimage")}else{if(B.querySelectorAll){s=B.querySelectorAll(".rwdimage")}else{return}}A=s.length;if(A===0){return}var k,E,m,n,H,I,d,w,b,e,h,g,v="",f,C,z,l,u=[],t,F=0,r=0,a=!!p.enquire,G;var c=function(i){return i.replace(/(^\s*)/,"").replace(/src:\s*/gi,"background-image: ").replace(/ratio\((\d+)\/(\d+)\)/gi,function(y,x,j){return((parseInt(x,10)/parseInt(j,10))*100)+"%"})};for(F;F<A;F++){k=s[F];k.setAttribute("data-rwdimage-id",F);E='[data-rwdimage-id="'+F+'"] ';m=k.getAttribute("data-rwdimage").split(",");n=m.length;u[F]={};u[F]["breakpoints"]=new Array(n);if(k.tagName.toLowerCase()==="img"){if(!k.src){k.src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEHAAAALAAAAAABAAEAAAICRAEAOw=="}if(a){k.setAttribute("data-rwdimage-has-enquire",true)}u[F]["isImage"]=true}u[F]["elem"]=B.querySelector(E);b=k.getAttribute("data-rwdimage-em")==="true"?true:false;e=k.getAttribute("data-rwdimage-em-base")?parseInt(k.getAttribute("data-rwdimage-em-base"),10):16;f="";for(var D=0;D<n;D++){H=c(m[D]);u[F]["breakpoints"][D]={};if(H.match(/^\(\s*?(min|max)/)){if(b){H=H.replace(/m(?:in|ax)-(?:width|height):\s*(\d+)px/gi,function(j,i){return j.replace(i,parseInt(i,10)/e).replace("px","em")})}f+="@media "+H.match(/.*?\{/)[0]+E+H.replace(/(\((min|max).*?\)|\s+and\s+)/g,"")+" }\n";u[F]["breakpoints"][D]["mediaquery"]=H.match(/(.*?)(\{)/)[1]}else{f+=E+H+"\n";u[F]["breakpoints"][D]["mediaquery"]=""}}d=k.getAttribute("data-rwdimage-retina")==="true"?true:false;w=k.getAttribute("data-rwdimage-retina-suffix")?k.getAttribute("data-rwdimage-retina-suffix"):"@2x";if(d){f=f.replace(/(^@media\s*?)(\(.*?)\{(.*?\[.*?)(\..*?\))(.*)/gm,"$1$2$3$4$5\n$1$2 and (min--moz-device-pixel-ratio: 1.3), $2 and (-o-min-device-pixel-ratio: 2.6/2), $2 and (-webkit-min-device-pixel-ratio: 1.3), $2 and (min-device-pixel-ratio: 1.3), $2 and (min-resolution: 1.3dppx) {$3"+w+"$4$5").replace(/(^\[.*?)(\..*?\))(.*)/gm,"$1$2$3\n@media (min--moz-device-pixel-ratio: 1.3), (-o-min-device-pixel-ratio: 2.6/2), (-webkit-min-device-pixel-ratio: 1.3), (min-device-pixel-ratio: 1.3), (min-resolution: 1.3dppx) { $1"+w+"$2$3 }")}h=k.getAttribute("data-rwdimage-fallback");if(h){g=k.getAttribute("data-rwdimage-fallback-class")?"."+k.getAttribute("data-rwdimage-fallback-class"):".ltie9";f+=g+" "+E+c(h)+"\n"}if(k.getAttribute("data-rwdimage-lazy-load")==="true"){f=f.replace(/(\[data-rwdimage-id="\d+"\])/g,".lazy-loaded$1")}v+=f}v=".rwdimage { background-repeat: no-repeat; background-size: contain; height: 0; width: 100%; }\n"+v+'.rwdimage[data-rwdimage-has-enquire="true"] { height: auto; padding-bottom: 0; width: auto; }\n';G=B.createElement("style");G.type="text/css";if(G.styleSheet){G.styleSheet.cssText=v}else{G.appendChild(B.createTextNode(v))}B.getElementsByTagName("head")[0].appendChild(G);p.rwdImageChangeSrc=function(j){if(j.tagName.toLowerCase()!=="img"){return}var i=!!p.getComputedStyle?p.getComputedStyle(j).getPropertyValue("background-image"):j.currentStyle.backgroundImage;i=i.replace(/url\((?:"|')?(.*?)(?:"|')?\)/,"$1");if(i!=="none"&&j.src!==i){j.src=i}};var o=function(i,j){if(!u[i]["breakpoints"][j]["mediaquery"]){return}enquire.register(u[i]["breakpoints"][j]["mediaquery"],function(){rwdImageChangeSrc(u[i]["elem"])})};for(r;r<u.length;r++){if(u[r]["isImage"]){for(var q=0;q<u[r]["breakpoints"].length;q++){if(a){o(r,q)}else{rwdImageChangeSrc(u[r]["elem"])}}}}})(window,document);